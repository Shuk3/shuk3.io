import{u as Y,g as se,h as te,i as B,j as le,P as ae,t as re,k as oe,l as F,m as x,n as ue,p as M,q as t,s as ie,R as j,v as ne,x as ce,y as pe,C as ve,z as de,A as he,B as ye,D as me,E as ge,F as Q,G as fe,H as He,I as Re,J as I,K as _,L as ke}from"./app-Qv7QuaiB.js";const qe=["/","/posts/feature.html","/posts/pyq.html","/posts/update-log.html","/posts/deploy/audio-to-text.html","/posts/deploy/exporter.html","/posts/deploy/install.html","/posts/deploy/manage-accounts.html","/posts/deploy/parser-db.html","/posts/deploy/save.html","/posts/error/faq.html","/posts/error/","/posts/error/unknown.html","/posts/error/vip-faq.html","/posts/develop/contact.html","/posts/develop/dataset.html","/posts/develop/deploy.html","/posts/develop/","/posts/develop/technology-info.html","/posts/develop/train.html","/posts/develop/train2.html","/404.html","/posts/","/posts/deploy/"],we="SEARCH_PRO_QUERY_HISTORY",g=Y(we,[]),xe=()=>{const{queryHistoryCount:l}=Q,a=l>0;return{enabled:a,queryHistory:g,addQueryHistory:r=>{a&&(g.value=Array.from(new Set([r,...g.value.slice(0,l-1)])))},removeQueryHistory:r=>{g.value=[...g.value.slice(0,r),...g.value.slice(r+1)]}}},P=l=>qe[l.id]+("anchor"in l?`#${l.anchor}`:""),Qe="SEARCH_PRO_RESULT_HISTORY",{resultHistoryCount:U}=Q,f=Y(Qe,[]),Se=()=>{const l=U>0;return{enabled:l,resultHistory:f,addResultHistory:a=>{if(l){const r={link:P(a),display:a.display};"header"in a&&(r.header=a.header),f.value=[r,...f.value.slice(0,U-1)]}},removeResultHistory:a=>{f.value=[...f.value.slice(0,a),...f.value.slice(a+1)]}}},Ce=l=>{const a=ve(),r=B(),S=de(),u=F(0),k=x(()=>u.value>0),h=he([]);return ye(()=>{const{search:y,terminate:C}=me(),H=ge(c=>{const R=c.join(" "),{searchFilter:L=d=>d,splitWord:D,suggestionsFilter:O,...m}=a.value;R?(u.value+=1,y(c.join(" "),r.value,m).then(d=>L(d,R,r.value,S.value)).then(d=>{u.value-=1,h.value=d}).catch(d=>{console.warn(d),u.value-=1,u.value||(h.value=[])})):h.value=[]},Q.searchDelay-Q.suggestDelay);M([l,r],([c])=>H(c),{immediate:!0}),fe(()=>{C()})}),{isSearching:k,results:h}};var De=se({name:"SearchResult",props:{queries:{type:Array,required:!0},isFocusing:Boolean},emits:["close","updateQuery"],setup(l,{emit:a}){const r=te(),S=B(),u=le(ae),{enabled:k,addQueryHistory:h,queryHistory:y,removeQueryHistory:C}=xe(),{enabled:H,resultHistory:c,addResultHistory:R,removeResultHistory:L}=Se(),D=k||H,O=re(l,"queries"),{results:m,isSearching:d}=Ce(O),o=oe({isQuery:!0,index:0}),p=F(0),v=F(0),T=x(()=>D&&(y.value.length>0||c.value.length>0)),b=x(()=>m.value.length>0),A=x(()=>m.value[p.value]||null),z=()=>{const{isQuery:e,index:s}=o;s===0?(o.isQuery=!e,o.index=e?c.value.length-1:y.value.length-1):o.index=s-1},G=()=>{const{isQuery:e,index:s}=o;s===(e?y.value.length-1:c.value.length-1)?(o.isQuery=!e,o.index=0):o.index=s+1},J=()=>{p.value=p.value>0?p.value-1:m.value.length-1,v.value=A.value.contents.length-1},K=()=>{p.value=p.value<m.value.length-1?p.value+1:0,v.value=0},V=()=>{v.value<A.value.contents.length-1?v.value+=1:K()},N=()=>{v.value>0?v.value-=1:J()},E=e=>e.map(s=>ke(s)?s:t(s[0],s[1])),W=e=>{if(e.type==="customField"){const s=He[e.index]||"$content",[i,w=""]=Re(s)?s[S.value].split("$content"):s.split("$content");return e.display.map(n=>t("div",E([i,...n,w])))}return e.display.map(s=>t("div",E(s)))},q=()=>{p.value=0,v.value=0,a("updateQuery",""),a("close")},X=()=>k?t("ul",{class:"search-pro-result-list"},t("li",{class:"search-pro-result-list-item"},[t("div",{class:"search-pro-result-title"},u.value.queryHistory),y.value.map((e,s)=>t("div",{class:["search-pro-result-item",{active:o.isQuery&&o.index===s}],onClick:()=>{a("updateQuery",e)}},[t(I,{class:"search-pro-result-type"}),t("div",{class:"search-pro-result-content"},e),t("button",{class:"search-pro-remove-icon",innerHTML:_,onClick:i=>{i.preventDefault(),i.stopPropagation(),C(s)}})]))])):null,Z=()=>H?t("ul",{class:"search-pro-result-list"},t("li",{class:"search-pro-result-list-item"},[t("div",{class:"search-pro-result-title"},u.value.resultHistory),c.value.map((e,s)=>t(j,{to:e.link,class:["search-pro-result-item",{active:!o.isQuery&&o.index===s}],onClick:()=>{q()}},()=>[t(I,{class:"search-pro-result-type"}),t("div",{class:"search-pro-result-content"},[e.header?t("div",{class:"content-header"},e.header):null,t("div",e.display.map(i=>E(i)).flat())]),t("button",{class:"search-pro-remove-icon",innerHTML:_,onClick:i=>{i.preventDefault(),i.stopPropagation(),L(s)}})]))])):null;return ue("keydown",e=>{if(l.isFocusing){if(b.value){if(e.key==="ArrowUp")N();else if(e.key==="ArrowDown")V();else if(e.key==="Enter"){const s=A.value.contents[v.value];h(l.queries.join(" ")),R(s),r.push(P(s)),q()}}else if(H){if(e.key==="ArrowUp")z();else if(e.key==="ArrowDown")G();else if(e.key==="Enter"){const{index:s}=o;o.isQuery?(a("updateQuery",y.value[s]),e.preventDefault()):(r.push(c.value[s].link),q())}}}}),M([p,v],()=>{var e;(e=document.querySelector(".search-pro-result-list-item.active .search-pro-result-item.active"))==null||e.scrollIntoView(!1)},{flush:"post"}),()=>t("div",{class:["search-pro-result-wrapper",{empty:l.queries.length?!b.value:!T.value}],id:"search-pro-results"},l.queries.length?d.value?t(ie,{hint:u.value.searching}):b.value?t("ul",{class:"search-pro-result-list"},m.value.map(({title:e,contents:s},i)=>{const w=p.value===i;return t("li",{class:["search-pro-result-list-item",{active:w}]},[t("div",{class:"search-pro-result-title"},e||u.value.defaultTitle),s.map((n,ee)=>{const $=w&&v.value===ee;return t(j,{to:P(n),class:["search-pro-result-item",{active:$,"aria-selected":$}],onClick:()=>{h(l.queries.join(" ")),R(n),q()}},()=>[n.type==="text"?null:t(n.type==="title"?ne:n.type==="heading"?ce:pe,{class:"search-pro-result-type"}),t("div",{class:"search-pro-result-content"},[n.type==="text"&&n.header?t("div",{class:"content-header"},n.header):null,t("div",W(n))])])})])})):u.value.emptyResult:D?T.value?[X(),Z()]:u.value.emptyHistory:u.value.emptyResult)}});export{De as default};
